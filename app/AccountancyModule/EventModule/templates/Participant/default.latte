{block #title}{$event->DisplayName} - seznam účastníků{/block}

{block #content}
<h2>{$event->DisplayName}</h2>
{include ../ActionMenu.latte}

{dump $list}
{dump $participants}


<<<<<<< HEAD
<div class="row-fluid visible-phone" id="potencial-menu">
    <a href="#participants-menu" class="btn btn-primary"><i class="icon icon-arrow-down icon-white"></i> Vybraní účastníci <i class="icon icon-arrow-down icon-white"></i></a>
</div>
<div class="row-fluid">
=======
                <a n:if="$isAllowParticipantInsert" class="btn btn-primary btn-small" href="#addParticipant" data-toggle="modal">Nový účastník</a>
            </div>
            <table class="table table-striped table-bordered">
                <thead class="onlyWithUnitPersons">
                    <tr>
                        <th style="width:30px">{*}
                        <input type="checkbox" class="hidden-phone" id="frmformMassAdd-all-all" onclick="jqCheckAll(this.id, 'all')" />
                        {input massAddSend class=>"btn btn-primary btn-mini allDependend hidden-phone", title=>"Přidat vybrané"}
                        {*}

                        </th>
                        <th>Příjmení a jméno</th>
                    </tr>
                </thead>
                <tbody class="dropable" id="{$unitTbodyId}">
                {if count($list) > 0}
                    <tr n:foreach="$list as $id=>$name" id='unit-par-row-{$id}' data-pid='{$id}'>
                        <td>
                        {*}{input all-$id class=>"hidden-phone"}{*}
                        {*}{if $isEditable}<a n:href="add! $id" class="btn btn-primary btn-mini ajax"><i class="icon-plus icon-white"></i></a>{/if}{*}
                        {if $isAllowParticipantInsert}<a n:href="add! $id" class="btn btn-primary btn-mini addRow"><i class="icon-plus icon-white"></i></a>{/if}
                        </td>
                        <td>{*}<i class="icon icon-move hidden-tablet hidden-phone" style='float: right;'></i> {*}{$name}{*{label all-$id /}*}</td>
                    </tr>
                {/if}
                    <tr class="alert info no-unit-persons" draggable="false"><td colspan="2"><b>Nejsou žádné nevybrané osoby v jednotce.</b></td></tr>
                </tbody>
            </table>
            {*}{/form}{*}
        {/snippet}
    </div>

<div class="row-fluid wipeBox visible-phone" id="participants-menu">
    <a href="#potencial-menu" class="btn btn-primary"><i class="icon icon-arrow-up icon-white"></i> Nevybraní účastníci <i class="icon icon-arrow-up icon-white"></i></a>
</div>
    <div class="span6">
        {snippet participants}
{*}{form formMassParticipants}{*}
{assign $tabIndex = 1}
        <div n:ifset="$participants">
            <h3>Seznam účastníků</h3>
            {var $participantsNames = []}
            <div class="well well-small hidden-phone">
                {if $isAllowParticipantDetail}
                <a n:href="export $aid" target="_blank" class="btn btn-info btn-small{if empty($participants)} disabled{/if}"><i class="icon icon-white icon-print"></i> Seznam účastníků</a>
                {else}
                <p class="alert alert-info">Nemáte oprávnění zobrazit informace o účastnících!</p>
                {/if}
            </div>

            <table id="participants-list" class="table table-striped table-bordered">
                <thead class="onlyWithParticipants">
                    <tr>
                        <th>Příjmení a jméno ({= count($participants)})</th>
                        <th>Dnů &nbsp; </th>
                        <th>Částka</th>
                    {*}
                    <th class="hidden-phone" n:if="$accessUpdateParticipant || $accessDeleteParticipant" style="width:90px;">
                        <input type="checkbox" id="frmformMassParticipants-ids-all" onclick="jqCheckAll(this.id, 'ids')" />
                        {if $accessDeleteParticipant}{input massRemoveSend class=>"btn btn-danger btn-mini massDependend", title=>"Odebrat vybrané"}{/if}
                        <a n:if="$accessUpdateParticipant" href="#massEdit" data-toggle="modal" class="btn btn-primary btn-mini massDependend" title="Upravit vybrané"><i class="icon-edit icon-white"></i></a>
                    </th>
                    {*}
                        {if  $accessUpdateParticipant || $accessDeleteParticipant}
                        <th class="hidden-phone"  style="width:30px;"> &nbsp; </th>
                        <th class="visible-phone"> &nbsp; </th>
                        {/if}
                    </tr>
                </thead>
                {var $total = 0}
                <tbody class="dropable" id="participants-list-tbody">
                    {if !empty($participants)}
                    <tr n:foreach="$participants as $p" id='par-list-row-{$p->ID}' data-pid='{$p->ID}'>
                    {? $participantsNames[] = $p->Person}
                        <td>{*}{label ids-$p->ID /}{*}{*}<i class="icon icon-move hidden-tablet hidden-phone"></i> {*}{$p->Person}</td>
                        <td><a id="par-days-{$p->ID}"{if $isAllowParticipantDays} class="num-edit" data-type="days" data-id="{$p->ID}" tabindex="{$tabIndex++}"{/if}>{$p->Days}</a></td>
                        <td><a id="par-payment-{$p->ID}"{if isAllowParticipantDays} class="num-edit" data-type='payment' data-id="{$p->ID}" tabindex="{$tabIndex++}"{/if} >{if isset($p->Note) && $p->Note != ""}{$p->Note}{? $total += $p->Note}{else}0{/if}</a></td>
                        <td n:if="$accessUpdateParticipant || $accessDeleteParticipant">
                        {*}
                        {input ids-$p->ID class=>"hidden-phone"}
                        <a n:if="$accessUpdateParticipant" class="fancybox fancybox.ajax btn btn-primary btn-mini hidden-phone" n:href="edit $aid, $p->ID, $p->Days, $p->Note"><i class="icon-edit icon-white"></i></a>
                        <a n:if="$accessUpdateParticipant" class="fancybox fancybox.ajax btn btn-primary btn-small visible-phone" n:href="edit $aid, $p->ID, $p->Days, $p->Note"><i class="icon-edit icon-white"></i></a>
                        {*}
                            <a n:if="$accessDeleteParticipant" n:href="remove! $p->ID" class="btn btn-danger btn-mini addRow"><i class="icon-remove icon-white"></i></a>
                        </td>
                    </tr>
                    {/if}
                    <tr class="alert info noparticipants" id="noparticipant" draggable="false"><td colspan="4"><b>Nejsou vybráni žádní účastníci.</b></td></tr>
                </tbody>
                <tfoot class="onlyWithParticipants">
                    <tr>
                        <td colspan="2"><b>Celkem</b></td>
                        <td><b id="payment-total">{$total}</b></td>
                    {*}<td n:if="$accessUpdateParticipant || $accessDeleteParticipant">&nbsp;</td>{*}
                        <td n:if="$accessUpdateParticipant || $accessDeleteParticipant">&nbsp;</td>
                    </tr>
                </tfoot>
            </table>
        </div>
    {* hromadné úpravy účastníků*}
{*}
    {if $isEditable}
        <div class="modal myModal fade" id="massEdit">
            <div class="modal-header">
                <a class="close" data-dismiss="modal">×</a>
                <h2>Hromadné nastavení</h2>
            </div>
            <div class="modal-body">
                <table>
                    <tr>
                        <td>Dní</td>
                        <td>{input days style=>"width:40px"}</td>
                    </tr>
                    <tr>
                        <td>Částka </td>
                        <td>{input payment style=>"width:40px"}</td>
                    </tr>
                    <tr>
                        <td colspan="2">{input massEditSend}</td>
                    </tr>
                </table>

            </div>
        </div>
    {/if}
        {*}
        
        {*}{/form}{*}
        <script type="text/javascript">
        $(document).ready(function() {
            participantsList = $({$participantsNames});
            if(participantsList.size() == 0){
                $(".noparticipants").show();
                $(".onlyWithParticipants").hide();
            } else {
                $(".noparticipants").hide();
                $(".onlyWithParticipants").show();
            }
            $unitPersons = $("#unit-participants-tbody tr:not(.no-unit-persons)");
            if($unitPersons.size() == 0){
                $(".no-unit-persons").show();
                $(".onlyWithUnitPersons").hide();
            } else {
                $(".no-unit-persons").hide();
                $(".onlyWithUnitPersons").show();
            }        

        {*} $("input[type=text][id^=frmformMassParticipants-isChange-]").change(function (){
                $("#"+this.id+"c").attr('checked', true);
            });
    
            //potencials
            $(".allDependend").addClass("disabled").attr("disabled", "disabled");
            onlyWithCheckbox("frmformMassAdd-all-", "allDependend");
    
            //participants
            $(".massDependend").addClass("disabled").attr("disabled", "disabled");
            onlyWithCheckbox("frmformMassParticipants-ids-", "massDependend");
>>>>>>> fedd5cf913306c3b38f94f7ad39575df78d1b293
    
    {include $templateBlockDir.'participants/list.latte'}
    {include $templateBlockDir.'participants/participant.latte'}

</div>

{if $isAllowParticipantInsert}
{* nový účastník *}
<div class="modal myModal fade" id="addParticipant">
    <div class="modal-header">
        <a class="close" data-dismiss="modal">×</a>
        <h2>Založit nového účastníka</h2>
    </div>
    <div class="modal-body">
            {control formAddParticipantNew}
    </div>
</div>
{/if}

{include $templateBlockDir.'participants/js.latte'}
{include $templateBlockDir.'inline-num-edit.latte'}
